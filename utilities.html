
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Utilities &#8212; Any-VM 0.1.0 documentation</title>
    <link rel="stylesheet" href="_static/better.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="API Reference" href="memory.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  </head>
  <body>
    <header id="pageheader"><h1><a href="index.html ">
        Any-VM 0.1.0 documentation
    </a></h1></header>
  <div class="related top">
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="memory.html" title="Previous document">API Reference</a>
        </li>
    </ul>
  </nav>
  <nav id="breadcrumbs">
    <ul>
      <li><a href="index.html">Any-VM 0.1.0 documentation</a></li> 
    </ul>
  </nav>
  </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="utilities">
<h1>Utilities<a class="headerlink" href="#utilities" title="Permalink to this headline">¶</a></h1>
<div class="section" id="intrusive-linked-list">
<h2>Intrusive Linked-List<a class="headerlink" href="#intrusive-linked-list" title="Permalink to this headline">¶</a></h2>
<dl class="struct">
<dt id="c.alist_t">
<span class="target" id="any-vmstructalist__t"></span><em class="property">struct </em><code class="descname">alist_t</code><a class="headerlink" href="#c.alist_t" title="Permalink to this definition">¶</a></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.alist_t::root">
<span class="target" id="any-vmstructalist__t_1a74bfef78ab69c1ab5b47349ae7fa80da"></span><a class="reference internal" href="#c.alist_node_t" title="alist_node_t">alist_node_t</a> <code class="descname">root</code><a class="headerlink" href="#c.alist_t::root" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="struct">
<dt id="c.alist_node_t">
<span class="target" id="any-vmstructalist__node__t"></span><em class="property">struct </em><code class="descname">alist_node_t</code><a class="headerlink" href="#c.alist_node_t" title="Permalink to this definition">¶</a></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.alist_node_t::next">
<span class="target" id="any-vmstructalist__node__t_1a293db583670c84d552a243e3405ed0e8"></span>struct <a class="reference internal" href="#c.alist_node_t" title="alist_node_t">alist_node_t</a>* <code class="descname">next</code><a class="headerlink" href="#c.alist_node_t::next" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.alist_node_t::prev">
<span class="target" id="any-vmstructalist__node__t_1ac2a3fbe7c78be9b7e6ef3e63a80811ab"></span>struct <a class="reference internal" href="#c.alist_node_t" title="alist_node_t">alist_node_t</a>* <code class="descname">prev</code><a class="headerlink" href="#c.alist_node_t::prev" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="function">
<dt id="c.alist_init">
<span class="target" id="any-vmlist_8h_1a9912bb94d2449885c8376f241bf496b3"></span>static void <code class="descname">alist_init</code><span class="sig-paren">(</span><a class="reference internal" href="#c.alist_t" title="alist_t">alist_t</a>  *<em>&nbsp;self</em><span class="sig-paren">)</span><a class="headerlink" href="#c.alist_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize as a new list. </p>
</dd></dl>

<dl class="function">
<dt id="c.alist_node_insert">
<span class="target" id="any-vmlist_8h_1aaff4d1974ccd7a6a156cb299f1755863"></span>static void <code class="descname">alist_node_insert</code><span class="sig-paren">(</span><a class="reference internal" href="#c.alist_node_t" title="alist_node_t">alist_node_t</a>  *<em>&nbsp;self</em>, <a class="reference internal" href="#c.alist_node_t" title="alist_node_t">alist_node_t</a>  *<em>&nbsp;prev</em>, <a class="reference internal" href="#c.alist_node_t" title="alist_node_t">alist_node_t</a>  *<em>&nbsp;next</em><span class="sig-paren">)</span><a class="headerlink" href="#c.alist_node_insert" title="Permalink to this definition">¶</a></dt>
<dd><p>Add node between next and previous. </p>
</dd></dl>

<dl class="function">
<dt id="c.alist_push_head">
<span class="target" id="any-vmlist_8h_1a6819c890275e370153dfab5817852369"></span>static void <code class="descname">alist_push_head</code><span class="sig-paren">(</span><a class="reference internal" href="#c.alist_t" title="alist_t">alist_t</a>  *<em>&nbsp;self</em>, <a class="reference internal" href="#c.alist_node_t" title="alist_node_t">alist_node_t</a>  *<em>&nbsp;node</em><span class="sig-paren">)</span><a class="headerlink" href="#c.alist_push_head" title="Permalink to this definition">¶</a></dt>
<dd><p>Add node to head of list. </p>
</dd></dl>

<dl class="function">
<dt id="c.alist_push_back">
<span class="target" id="any-vmlist_8h_1afe82fd79f3a4166c1c9902fddc7c9b70"></span>static void <code class="descname">alist_push_back</code><span class="sig-paren">(</span><a class="reference internal" href="#c.alist_t" title="alist_t">alist_t</a>  *<em>&nbsp;self</em>, <a class="reference internal" href="#c.alist_node_t" title="alist_node_t">alist_node_t</a>  *<em>&nbsp;node</em><span class="sig-paren">)</span><a class="headerlink" href="#c.alist_push_back" title="Permalink to this definition">¶</a></dt>
<dd><p>Add node to back of list. </p>
</dd></dl>

<dl class="function">
<dt id="c.alist_node_erase">
<span class="target" id="any-vmlist_8h_1a52a0e2c82e6e0ff895a624b86fd0b2a3"></span>static void <code class="descname">alist_node_erase</code><span class="sig-paren">(</span><a class="reference internal" href="#c.alist_node_t" title="alist_node_t">alist_node_t</a>  *<em>&nbsp;self</em><span class="sig-paren">)</span><a class="headerlink" href="#c.alist_node_erase" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove node from list. </p>
</dd></dl>

<dl class="function">
<dt id="c.alist_head">
<span class="target" id="any-vmlist_8h_1ae4eb3635065af7317b823e56639a60c6"></span>static <a class="reference internal" href="#c.alist_node_t" title="alist_node_t">alist_node_t</a>* <code class="descname">alist_head</code><span class="sig-paren">(</span><a class="reference internal" href="#c.alist_t" title="alist_t">alist_t</a>  *<em>&nbsp;self</em><span class="sig-paren">)</span><a class="headerlink" href="#c.alist_head" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the fist node. </p>
</dd></dl>

<dl class="function">
<dt id="c.alist_back">
<span class="target" id="any-vmlist_8h_1a39ee49fb619dbaafc4d3e1722414a23e"></span>static <a class="reference internal" href="#c.alist_node_t" title="alist_node_t">alist_node_t</a>* <code class="descname">alist_back</code><span class="sig-paren">(</span><a class="reference internal" href="#c.alist_t" title="alist_t">alist_t</a>  *<em>&nbsp;self</em><span class="sig-paren">)</span><a class="headerlink" href="#c.alist_back" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the last node. </p>
</dd></dl>

<dl class="function">
<dt id="c.alist_is_end">
<span class="target" id="any-vmlist_8h_1a44b6b84146786a4862fe70528461bfdb"></span>static int32_t <code class="descname">alist_is_end</code><span class="sig-paren">(</span><a class="reference internal" href="#c.alist_t" title="alist_t">alist_t</a>  *<em>&nbsp;self</em>, <a class="reference internal" href="#c.alist_node_t" title="alist_node_t">alist_node_t</a>  *<em>&nbsp;node</em><span class="sig-paren">)</span><a class="headerlink" href="#c.alist_is_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether node is end. </p>
</dd></dl>

</div>
<div class="section" id="function-prototype">
<h2>Function Prototype<a class="headerlink" href="#function-prototype" title="Permalink to this headline">¶</a></h2>
<dl class="struct">
<dt id="c.aprototype_header_t">
<span class="target" id="any-vmstructaprototype__header__t"></span><em class="property">struct </em><code class="descname">aprototype_header_t</code><a class="headerlink" href="#c.aprototype_header_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Function prototype. </p>
<p>This struct represents the header portion of a function prototype. Prototype is self-contained and relocatable, references are relative to their corresponding header. That means we can safety copy a memory blob of prototype and move that around, save to and loaded from disk without any need for patching.</p>
<p>The first prototype in chunk is <code class="docutils literal"><span class="pre">module</span> <span class="pre">prototype</span></code>, there are no global scope in AVM. The most outer scope is <code class="docutils literal"><span class="pre">module</span></code>, which is only consists of nested function and constant. There are no instruction, up-value, argument, local var and import in this kind of prototype. Either that make non-sense or strictly prohibited to prevent the possibility of race condition. Nested of module prototype is <code class="docutils literal"><span class="pre">module</span> <span class="pre">function</span></code>. Which can be exported by the name specified in <code class="docutils literal"><span class="pre">symbol</span></code>. That allows such functions to be imported to use by other modules.</p>
<p>In AVM, there are two kind of string, <code class="docutils literal"><span class="pre">static</span></code> and <code class="docutils literal"><span class="pre">collectable</span></code>. Compile time string are <code class="docutils literal"><span class="pre">static</span></code> and must be referenced by <code class="docutils literal"><span class="pre">astring_ref_t</span></code> which is just an offset to the dedicated <strong>per prototype</strong> string pool. We don’t want to share these pools between prototype to make relocating trivial. General speaking, the whole prototype is read-only, which is only accessible using related instruction to ensure the thread safety and security, we could easily mmap a prototype from storages, as well as traditional OS executable.</p>
<p><dl class="docutils">
<dt><strong>Memory layout:</strong></dt>
<dd><table border="1" class="docutils">
<colgroup>
<col width="62%" />
<col width="38%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">bytes</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>4 signed</td>
<td>source file name</td>
</tr>
<tr class="row-odd"><td>4 signed</td>
<td>to be exported</td>
</tr>
<tr class="row-even"><td>4 signed</td>
<td>num of string bytes</td>
</tr>
<tr class="row-odd"><td>4 signed</td>
<td>num of instructions</td>
</tr>
<tr class="row-even"><td>2 signed</td>
<td>num of nesteds</td>
</tr>
<tr class="row-odd"><td>1 unsigned</td>
<td>num of up-values</td>
</tr>
<tr class="row-even"><td>1 unsigned</td>
<td>num of arguments</td>
</tr>
<tr class="row-odd"><td>1 unsigned</td>
<td>num of constants</td>
</tr>
<tr class="row-even"><td>1 unsigned</td>
<td>num of local variables</td>
</tr>
<tr class="row-odd"><td>1 unsigned</td>
<td>num of imports</td>
</tr>
<tr class="row-even"><td>1</td>
<td>_</td>
</tr>
<tr class="row-odd"><td>num of string bytes</td>
<td>strings</td>
</tr>
<tr class="row-even"><td>n * sizeof(<a class="reference internal" href="#c.ainstruction_t" title="ainstruction_t"><code class="xref c c-type docutils literal"><span class="pre">ainstruction_t</span></code></a>)</td>
<td>instructions</td>
</tr>
<tr class="row-odd"><td>n * sizeof(<code class="xref c c-type docutils literal"><span class="pre">aconstant_t</span></code>)</td>
<td>constants</td>
</tr>
<tr class="row-even"><td>n * sizeof(<a class="reference internal" href="#c.aimport_t" title="aimport_t"><code class="xref c c-type docutils literal"><span class="pre">aimport_t</span></code></a>)</td>
<td>imports</td>
</tr>
<tr class="row-odd"><td>_</td>
<td>nested prototypes</td>
</tr>
</tbody>
</table>
 </dd>
</dl>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.aprototype_header_t::source">
<span class="target" id="any-vmstructaprototype__header__t_1a08e0c90a23cab18691e83eadc0ab8763"></span>astring_ref_t <code class="descname">source</code><a class="headerlink" href="#c.aprototype_header_t::source" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.aprototype_header_t::symbol">
<span class="target" id="any-vmstructaprototype__header__t_1abca27f9b0fca9167905e17cb500f936a"></span>astring_ref_t <code class="descname">symbol</code><a class="headerlink" href="#c.aprototype_header_t::symbol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.aprototype_header_t::strings_sz">
<span class="target" id="any-vmstructaprototype__header__t_1a79d20cfab57686bfc183bc8c8c18491d"></span>int32_t <code class="descname">strings_sz</code><a class="headerlink" href="#c.aprototype_header_t::strings_sz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.aprototype_header_t::num_instructions">
<span class="target" id="any-vmstructaprototype__header__t_1ab1c41d039cb211628a8f4bf783a48435"></span>int32_t <code class="descname">num_instructions</code><a class="headerlink" href="#c.aprototype_header_t::num_instructions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.aprototype_header_t::num_nesteds">
<span class="target" id="any-vmstructaprototype__header__t_1a6c100795bdf9422e2eaa7f189cfb798c"></span>int16_t <code class="descname">num_nesteds</code><a class="headerlink" href="#c.aprototype_header_t::num_nesteds" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.aprototype_header_t::num_upvalues">
<span class="target" id="any-vmstructaprototype__header__t_1ad624d98de1cbe40650f841abc95c4c6e"></span>uint8_t <code class="descname">num_upvalues</code><a class="headerlink" href="#c.aprototype_header_t::num_upvalues" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.aprototype_header_t::num_arguments">
<span class="target" id="any-vmstructaprototype__header__t_1a452360b31c9601506f5db1402a6128c8"></span>uint8_t <code class="descname">num_arguments</code><a class="headerlink" href="#c.aprototype_header_t::num_arguments" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.aprototype_header_t::num_constants">
<span class="target" id="any-vmstructaprototype__header__t_1a6051d4ea083a84394e847c9d9503dc94"></span>uint8_t <code class="descname">num_constants</code><a class="headerlink" href="#c.aprototype_header_t::num_constants" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.aprototype_header_t::num_local_vars">
<span class="target" id="any-vmstructaprototype__header__t_1a679f2f6517b2564d9cdf43a78b38d384"></span>uint8_t <code class="descname">num_local_vars</code><a class="headerlink" href="#c.aprototype_header_t::num_local_vars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.aprototype_header_t::num_imports">
<span class="target" id="any-vmstructaprototype__header__t_1aab649ee167c87ce2a0ffa6d0fbf795ac"></span>uint8_t <code class="descname">num_imports</code><a class="headerlink" href="#c.aprototype_header_t::num_imports" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="struct">
<dt id="c.aimport_t">
<span class="target" id="any-vmstructaimport__t"></span><em class="property">struct </em><code class="descname">aimport_t</code><a class="headerlink" href="#c.aimport_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Function import. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.aimport_t::module">
<span class="target" id="any-vmstructaimport__t_1a8b1a3ebcf568aeec9f4578e4ef98edde"></span>astring_ref_t <code class="descname">module</code><a class="headerlink" href="#c.aimport_t::module" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.aimport_t::name">
<span class="target" id="any-vmstructaimport__t_1ad2b8140da451f159206de25a2ea1ed0c"></span>astring_ref_t <code class="descname">name</code><a class="headerlink" href="#c.aimport_t::name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</dd></dl>

<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">doxygenstruct: Cannot find class “aconstant_t” in doxygen xml output for project “any-vm” from directory: .doxyxml/</p>
</div>
</div>
<div class="section" id="instruction-set">
<h2>Instruction Set<a class="headerlink" href="#instruction-set" title="Permalink to this headline">¶</a></h2>
<dl class="struct">
<dt id="c.ai_base_t">
<span class="target" id="any-vmstructai__base__t"></span><em class="property">struct </em><code class="descname">ai_base_t</code><a class="headerlink" href="#c.ai_base_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Base type. </p>
<p><table border="1" class="docutils">
<colgroup>
<col width="46%" />
<col width="54%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">8 bits</th>
<th class="head">24 bits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>opcode</td>
<td>payload</td>
</tr>
</tbody>
</table>
 </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.ai_base_t::opcode">
<span class="target" id="any-vmstructai__base__t_1adde1d533a26ba0140d4923ef310acd28"></span>uint32_t <code class="descname">opcode</code><a class="headerlink" href="#c.ai_base_t::opcode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="struct">
<dt id="c.ai_nop_t">
<span class="target" id="any-vmstructai__nop__t"></span><em class="property">struct </em><code class="descname">ai_nop_t</code><a class="headerlink" href="#c.ai_nop_t" title="Permalink to this definition">¶</a></dt>
<dd><p>No operation. </p>
<p><table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">8 bits</th>
<th class="head">24 bits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>AOC_NOP</td>
<td>_</td>
</tr>
</tbody>
</table>
 </p>
</dd></dl>

<dl class="struct">
<dt id="c.ai_pop_t">
<span class="target" id="any-vmstructai__pop__t"></span><em class="property">struct </em><code class="descname">ai_pop_t</code><a class="headerlink" href="#c.ai_pop_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Pop <code class="docutils literal"><span class="pre">n</span></code> elements from the stack. </p>
<p><table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">8 bits</th>
<th class="head">24 bits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>AOC_POP</td>
<td>n</td>
</tr>
</tbody>
</table>
 </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.ai_pop_t::n">
<span class="target" id="any-vmstructai__pop__t_1ab5bad646ad55b96cd0df06b0d0247777"></span>int32_t <code class="descname">n</code><a class="headerlink" href="#c.ai_pop_t::n" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="struct">
<dt id="c.ai_ldk_t">
<span class="target" id="any-vmstructai__ldk__t"></span><em class="property">struct </em><code class="descname">ai_ldk_t</code><a class="headerlink" href="#c.ai_ldk_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Push a constant from const pool at <code class="docutils literal"><span class="pre">idx</span></code> onto the stack. </p>
<p><table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">8 bits</th>
<th class="head">24 bits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>AOC_LDK</td>
<td>idx</td>
</tr>
</tbody>
</table>
 </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.ai_ldk_t::idx">
<span class="target" id="any-vmstructai__ldk__t_1a68bca12206ef20cb8530db39cc213f99"></span>int32_t <code class="descname">idx</code><a class="headerlink" href="#c.ai_ldk_t::idx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="struct">
<dt id="c.ai_nil_t">
<span class="target" id="any-vmstructai__nil__t"></span><em class="property">struct </em><code class="descname">ai_nil_t</code><a class="headerlink" href="#c.ai_nil_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Push a nil value onto the stack. </p>
<p><table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">8 bits</th>
<th class="head">24 bits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>AOC_NIL</td>
<td>_</td>
</tr>
</tbody>
</table>
 </p>
</dd></dl>

<dl class="struct">
<dt id="c.ai_ldb_t">
<span class="target" id="any-vmstructai__ldb__t"></span><em class="property">struct </em><code class="descname">ai_ldb_t</code><a class="headerlink" href="#c.ai_ldb_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Push a bool value <code class="docutils literal"><span class="pre">val</span></code> onto the stack. </p>
<p><table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">8 bits</th>
<th class="head">24 bits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>AOC_LDB</td>
<td>val</td>
</tr>
</tbody>
</table>
 </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.ai_ldb_t::val">
<span class="target" id="any-vmstructai__ldb__t_1ae953589688d8476ff524e25f5581e551"></span>int32_t <code class="descname">val</code><a class="headerlink" href="#c.ai_ldb_t::val" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="struct">
<dt id="c.ai_llv_t">
<span class="target" id="any-vmstructai__llv__t"></span><em class="property">struct </em><code class="descname">ai_llv_t</code><a class="headerlink" href="#c.ai_llv_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Push a value from local pool at <code class="docutils literal"><span class="pre">idx</span></code> onto the stack. </p>
<p><table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">8 bits</th>
<th class="head">24 bits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>AOC_LLV</td>
<td>idx</td>
</tr>
</tbody>
</table>
 </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.ai_llv_t::idx">
<span class="target" id="any-vmstructai__llv__t_1aa5d3478f86dfa643e251e0e2e22daeed"></span>int32_t <code class="descname">idx</code><a class="headerlink" href="#c.ai_llv_t::idx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="struct">
<dt id="c.ai_slv_t">
<span class="target" id="any-vmstructai__slv__t"></span><em class="property">struct </em><code class="descname">ai_slv_t</code><a class="headerlink" href="#c.ai_slv_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Pop a value from the stack and set it into the local pool at <code class="docutils literal"><span class="pre">idx</span></code>. </p>
<p><table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">8 bits</th>
<th class="head">24 bits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>AOC_SLV</td>
<td>idx</td>
</tr>
</tbody>
</table>
 </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.ai_slv_t::idx">
<span class="target" id="any-vmstructai__slv__t_1aee865793bf8313b5b762358aa62a2a31"></span>int32_t <code class="descname">idx</code><a class="headerlink" href="#c.ai_slv_t::idx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="struct">
<dt id="c.ai_imp_t">
<span class="target" id="any-vmstructai__imp__t"></span><em class="property">struct </em><code class="descname">ai_imp_t</code><a class="headerlink" href="#c.ai_imp_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Push a value from import pool at <code class="docutils literal"><span class="pre">idx</span></code> onto the stack. </p>
<p><table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">8 bits</th>
<th class="head">24 bits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>AOC_IMP</td>
<td>idx</td>
</tr>
</tbody>
</table>
 </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.ai_imp_t::idx">
<span class="target" id="any-vmstructai__imp__t_1a7d99b6d7718079114eece612e637a62d"></span>int32_t <code class="descname">idx</code><a class="headerlink" href="#c.ai_imp_t::idx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="struct">
<dt id="c.ai_jmp_t">
<span class="target" id="any-vmstructai__jmp__t"></span><em class="property">struct </em><code class="descname">ai_jmp_t</code><a class="headerlink" href="#c.ai_jmp_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Unconditional jump, with signed <code class="docutils literal"><span class="pre">displacement</span></code>. </p>
<p><table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">8 bits</th>
<th class="head">24 bits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>AOC_JMP</td>
<td>displacement</td>
</tr>
</tbody>
</table>
 </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.ai_jmp_t::displacement">
<span class="target" id="any-vmstructai__jmp__t_1a75ff0af39dd9a11b8840d2577989b6bc"></span>int32_t <code class="descname">displacement</code><a class="headerlink" href="#c.ai_jmp_t::displacement" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="struct">
<dt id="c.ai_jin_t">
<span class="target" id="any-vmstructai__jin__t"></span><em class="property">struct </em><code class="descname">ai_jin_t</code><a class="headerlink" href="#c.ai_jin_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Conditional jump, with signed <code class="docutils literal"><span class="pre">displacement</span></code>. </p>
<p>Pop a boolean value from the stack and jump if it’s nil or false. <table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">8 bits</th>
<th class="head">24 bits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>AOC_JIN</td>
<td>displacement</td>
</tr>
</tbody>
</table>
 </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.ai_jin_t::displacement">
<span class="target" id="any-vmstructai__jin__t_1a36b283ddd6ba4e9b10cc9c9e11c35f2a"></span>int32_t <code class="descname">displacement</code><a class="headerlink" href="#c.ai_jin_t::displacement" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="struct">
<dt id="c.ai_ivk_t">
<span class="target" id="any-vmstructai__ivk__t"></span><em class="property">struct </em><code class="descname">ai_ivk_t</code><a class="headerlink" href="#c.ai_ivk_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Function call. </p>
<p>Please refer <a class="reference internal" href="runtime.html#any-vmstructaprocess__t"><span class="std std-ref">aprocess_t</span></a> for the protocol. <dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>Result will be placed on top of the stack. <table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">8 bits</th>
<th class="head">24 bits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>AOC_IVK</td>
<td>nargs</td>
</tr>
</tbody>
</table>
 </dd>
</dl>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.ai_ivk_t::nargs">
<span class="target" id="any-vmstructai__ivk__t_1a57e94a9be7aad2adbbeec689af496b75"></span>int32_t <code class="descname">nargs</code><a class="headerlink" href="#c.ai_ivk_t::nargs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="struct">
<dt id="c.ai_ret_t">
<span class="target" id="any-vmstructai__ret__t"></span><em class="property">struct </em><code class="descname">ai_ret_t</code><a class="headerlink" href="#c.ai_ret_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Returning from a function call. </p>
<p>Top of the stack will be returned as the result. <table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">8 bits</th>
<th class="head">24 bits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>AOC_RET</td>
<td>_</td>
</tr>
</tbody>
</table>
 </p>
</dd></dl>

<dl class="struct">
<dt id="c.ai_snd_t">
<span class="target" id="any-vmstructai__snd__t"></span><em class="property">struct </em><code class="descname">ai_snd_t</code><a class="headerlink" href="#c.ai_snd_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Pop a target pid and next a message from the stack and send it. </p>
<p><table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">8 bits</th>
<th class="head">24 bits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>AOC_SND</td>
<td>_</td>
</tr>
</tbody>
</table>
 </p>
</dd></dl>

<dl class="struct">
<dt id="c.ai_rcv_t">
<span class="target" id="any-vmstructai__rcv__t"></span><em class="property">struct </em><code class="descname">ai_rcv_t</code><a class="headerlink" href="#c.ai_rcv_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Picks up next message in the queue and places it onto the stack. </p>
<p>If there is no more message, jump to signed <code class="docutils literal"><span class="pre">displacement</span></code>. A <code class="docutils literal"><span class="pre">timeout</span></code> value will be popped from the stack, that will be used by AVM to determine if it must wait for this period before it decided that there is no more message in the queue. This <code class="docutils literal"><span class="pre">timeout</span></code> is signed and in milliseconds, a negative value means infinite waiting. <dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>This instruction will not remove messages from the queue. <table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">8 bits</th>
<th class="head">24 bits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>AOC_RCV</td>
<td>displacement</td>
</tr>
</tbody>
</table>
 </dd>
</dl>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.ai_rcv_t::displacement">
<span class="target" id="any-vmstructai__rcv__t_1ac4e0accc063edd904b2392f0e2ef2ca8"></span>int32_t <code class="descname">displacement</code><a class="headerlink" href="#c.ai_rcv_t::displacement" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="struct">
<dt id="c.ai_rmv_t">
<span class="target" id="any-vmstructai__rmv__t"></span><em class="property">struct </em><code class="descname">ai_rmv_t</code><a class="headerlink" href="#c.ai_rmv_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove current message which is previously peeked by <a class="reference internal" href="#any-vmstructai__rcv__t"><span class="std std-ref">ai_rcv_t</span></a>. </p>
<p>The peek pointer will be rewound to the front. <table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">8 bits</th>
<th class="head">24 bits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>AOC_RMV</td>
<td>_</td>
</tr>
</tbody>
</table>
 </p>
</dd></dl>

<dl class="union">
<dt id="c.ainstruction_t">
<span class="target" id="any-vmunionainstruction__t"></span><em class="property">union </em><code class="descname">ainstruction_t</code><a class="headerlink" href="#c.ainstruction_t" title="Permalink to this definition">¶</a></dt>
<dd><em>#include &lt;rt_types.h&gt;</em><p>Variant of instruction types, instruction size is fixed 4 bytes. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.ainstruction_t::b">
<span class="target" id="any-vmunionainstruction__t_1a5efab6dc4811d8a5423e1bb98c217476"></span><a class="reference internal" href="#c.ai_base_t" title="ai_base_t">ai_base_t</a> <code class="descname">b</code><a class="headerlink" href="#c.ainstruction_t::b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.ainstruction_t::nop">
<span class="target" id="any-vmunionainstruction__t_1a3d0d351f71c9faa77dda800fa0ae32ad"></span><a class="reference internal" href="#c.ai_nop_t" title="ai_nop_t">ai_nop_t</a> <code class="descname">nop</code><a class="headerlink" href="#c.ainstruction_t::nop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.ainstruction_t::pop">
<span class="target" id="any-vmunionainstruction__t_1a0f04a792b2c1eae32380ca16e8e5c11a"></span><a class="reference internal" href="#c.ai_pop_t" title="ai_pop_t">ai_pop_t</a> <code class="descname">pop</code><a class="headerlink" href="#c.ainstruction_t::pop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.ainstruction_t::ldk">
<span class="target" id="any-vmunionainstruction__t_1a5a773a6b03a4447741c2bb873bdcdd6d"></span><a class="reference internal" href="#c.ai_ldk_t" title="ai_ldk_t">ai_ldk_t</a> <code class="descname">ldk</code><a class="headerlink" href="#c.ainstruction_t::ldk" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.ainstruction_t::nil">
<span class="target" id="any-vmunionainstruction__t_1af438eda213abeb824e316f7894fbfc95"></span><a class="reference internal" href="#c.ai_nil_t" title="ai_nil_t">ai_nil_t</a> <code class="descname">nil</code><a class="headerlink" href="#c.ainstruction_t::nil" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.ainstruction_t::ldb">
<span class="target" id="any-vmunionainstruction__t_1afa401fc9ddd3398324dcb1e29f06a301"></span><a class="reference internal" href="#c.ai_ldb_t" title="ai_ldb_t">ai_ldb_t</a> <code class="descname">ldb</code><a class="headerlink" href="#c.ainstruction_t::ldb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.ainstruction_t::llv">
<span class="target" id="any-vmunionainstruction__t_1a2c3cb13c63fdbf3eee539d082925bde9"></span><a class="reference internal" href="#c.ai_llv_t" title="ai_llv_t">ai_llv_t</a> <code class="descname">llv</code><a class="headerlink" href="#c.ainstruction_t::llv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.ainstruction_t::slv">
<span class="target" id="any-vmunionainstruction__t_1a0874482b7ba0b50e149d1f7997aa3228"></span><a class="reference internal" href="#c.ai_slv_t" title="ai_slv_t">ai_slv_t</a> <code class="descname">slv</code><a class="headerlink" href="#c.ainstruction_t::slv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.ainstruction_t::imp">
<span class="target" id="any-vmunionainstruction__t_1af30a8d7acdb4c0f9658c3e4bcaf03a73"></span><a class="reference internal" href="#c.ai_imp_t" title="ai_imp_t">ai_imp_t</a> <code class="descname">imp</code><a class="headerlink" href="#c.ainstruction_t::imp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.ainstruction_t::jmp">
<span class="target" id="any-vmunionainstruction__t_1aebdd8aa814b3df70119f5fc80a54b264"></span><a class="reference internal" href="#c.ai_jmp_t" title="ai_jmp_t">ai_jmp_t</a> <code class="descname">jmp</code><a class="headerlink" href="#c.ainstruction_t::jmp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.ainstruction_t::jin">
<span class="target" id="any-vmunionainstruction__t_1ae139365e233938e3ad9b6d5efb8d64ba"></span><a class="reference internal" href="#c.ai_jin_t" title="ai_jin_t">ai_jin_t</a> <code class="descname">jin</code><a class="headerlink" href="#c.ainstruction_t::jin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.ainstruction_t::ivk">
<span class="target" id="any-vmunionainstruction__t_1ab750cbfe8997e7a69bc9b49be874b461"></span><a class="reference internal" href="#c.ai_ivk_t" title="ai_ivk_t">ai_ivk_t</a> <code class="descname">ivk</code><a class="headerlink" href="#c.ainstruction_t::ivk" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.ainstruction_t::ret">
<span class="target" id="any-vmunionainstruction__t_1a6385d0816eaaad1f47b7b85fe610153c"></span><a class="reference internal" href="#c.ai_ret_t" title="ai_ret_t">ai_ret_t</a> <code class="descname">ret</code><a class="headerlink" href="#c.ainstruction_t::ret" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.ainstruction_t::snd">
<span class="target" id="any-vmunionainstruction__t_1a07e156b26246b98fbe07369e62a90a78"></span><a class="reference internal" href="#c.ai_snd_t" title="ai_snd_t">ai_snd_t</a> <code class="descname">snd</code><a class="headerlink" href="#c.ainstruction_t::snd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.ainstruction_t::rcv">
<span class="target" id="any-vmunionainstruction__t_1a6ada60a64f6ebd135e88b8889e4f9263"></span><a class="reference internal" href="#c.ai_rcv_t" title="ai_rcv_t">ai_rcv_t</a> <code class="descname">rcv</code><a class="headerlink" href="#c.ainstruction_t::rcv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="c.ainstruction_t::rmv">
<span class="target" id="any-vmunionainstruction__t_1a8b82c9b4e6f56a17f30c5dcccab1e6ba"></span><a class="reference internal" href="#c.ai_rmv_t" title="ai_rmv_t">ai_rmv_t</a> <code class="descname">rmv</code><a class="headerlink" href="#c.ainstruction_t::rmv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Utilities</a><ul>
<li><a class="reference internal" href="#intrusive-linked-list">Intrusive Linked-List</a></li>
<li><a class="reference internal" href="#function-prototype">Function Prototype</a></li>
<li><a class="reference internal" href="#instruction-set">Instruction Set</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="memory.html"
                        title="previous chapter">API Reference</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/utilities.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<form class="search" action="search.html" method="get">
  <input type="text" name="q"
   placeholder="type to search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="related bottom">
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="memory.html" title="Previous document">API Reference</a>
        </li>
    </ul>
  </nav>
  <nav id="breadcrumbs">
    <ul>
      <li><a href="index.html">Any-VM 0.1.0 documentation</a></li> 
    </ul>
  </nav>
  </div>
  <footer id="pagefooter">&copy; 2017 Nguyễn Việt Giang. All rights reserved.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a>
      1.6.3
        with the <a href="http://github.com/irskep/sphinx-better-theme">
          better</a> theme.

  </footer>

  
  </body>
</html>